<template>
     <div>
          <section class="pageAnuncia">
               <div class="boxBackground">
                    <div class="container-fluid">
                         <div class="boxContent">
                              <div class="row">
                                   <div class="col-0 col-lg-1"></div>
                                   <div class="col-12 col-lg-5">
                                        <div class="boxTitle pingMenu">
                                             <h1>
                                                  <span class="colorYellow">Anuncia </span> aquí
                                             </h1>
                                        </div>
                                        <div class="boxSubTitle mt-4">
                                             <h2 class="colorYellow">¿Por qué unirte a Moto Popular?</h2>
                                        </div>
                                        <div class="boxDescription mt-3">
                                             <p class="colorYellow big">
                                                  Somos la primera web especializada en la venta de motos económicas en Perú. En nuestro portal encontrarás una variedad más amplia de vehículos que en cualquier tienda.
                                             </p>
                                        </div>
                                        <div class="boxDescription mt-3">
                                             <p>
                                                  Tenemos datos detallados y actualizados de las motos más comerciales para delivery y otros negocios. Cada modelo se sube con precio, fotos, videos para encontrar el precio que más te acomode.
                                             </p>
                                             <p class="mt-3">
                                                  Nuestras soluciones están mejorar los procesos de venta para alcanzar a más público y ayudarles a superar los obstáculos. Si el dinero es un problema para los clientes, ofrecemos financiamiento fácil y rápido en solo un click. Además, el cliente podrá contactar a un asesor especializado que le ayude a encontrar su moto BUSCADA.
                                             </p>
                                        </div>
                                   </div>
                                   <div class="col-12 col-lg-5 relative">
                                        <picture class="boxImageUser"> 
                                             <!-- <source media="(max-width: 799px)" srcset="elva-480w-close-portrait.jpg">
                                             <source media="(min-width: 800px)" srcset="elva-800w.jpg"> -->
                                             <img src="/frontend/images/a1.png" >
                                        </picture>
                                   </div>
                                   <div class="col-12 col-lg-1"></div>
                              </div>
                         </div>    
                    </div>
               </div>
               <div class="pasosAnuncia">
                    <div class="container-fluid">
                         <div class="row">
                              <div class="col-0 col-xl-1"></div>
                              <div class="col-12 col-xl-10">
                                   <div class="boxCardPasos d-flex justify-content-center align-items-start flex-wrap">
                                        <div>
                                             <div class="cardImage d-flex justify-content-center align-items-end">
                                                  <img src="/frontend/images/p1.png" >
                                             </div>
                                             <div class="cardInfo">
                                                  <h2>01</h2>
                                                  <h3>El cliente selecciona <br>la moto de su elecci&oacute;n </h3>
                                             </div>
                                        </div>
                                        <div>
                                             <div class="cardImage d-flex justify-content-center align-items-end">
                                                  <img src="/frontend/images/p2.png" >
                                             </div>
                                             <div class="cardInfo">
                                                  <h2>02</h2>
                                                  <h3>Elige el m&eacute;todo <br>de pago (al contado <br>o financiado)</h3>
                                             </div>
                                        </div>
                                        <div>
                                             <div class="cardImage d-flex justify-content-center align-items-end">
                                                  <img src="/frontend/images/p3.png" >
                                             </div>
                                             <div class="cardInfo">
                                                  <h2>03</h2>
                                                  <h3>Un asesor especializado <br>te contactar&aacute; y te <br>brindar&aacute; soluciones</h3>
                                             </div>
                                        </div>
                                        <div>
                                             <div class="cardImage d-flex justify-content-center align-items-end">
                                                  <img src="/frontend/images/p4.png" >
                                             </div>
                                             <div class="cardInfo">
                                                  <h2>04</h2>
                                                  <h3>Visitas el concecionario <br>y te llevas tu moto <br>a casa</h3>
                                             </div>
                                        </div>
                                   </div>
                              </div>
                              <div class="col-0 col-xl-1"></div>
                         </div>
                    </div>
               </div>
               <div class="anunciaForm">
                    <div class="container-fluid">
                         <div class="row">
                              <div class="col-0 col-xl-1"></div>
                              <div class="col-12 col-xl-10">
                                   <div class="row">
                                        <div class="col-12 col-md-6 col-xl-6">
                                             <div class="boxTitle">
                                                  <h2>
                                                       <span class="txtPopLight">¿Cómo anunciar en</span> <br>
                                                       <span class="colorYellow">Moto Popular?</span>
                                                  </h2>
                                             </div>
                                             <div class="boxDescription mt-4">
                                                  <p>
                                                       Si quieres que tus motos se exhiban en Moto Popular tan solo tienes que contactar con un asesor, acceder a los términos del contrato y con solo una firma ya estarás anunciando.
                                                  </p>
                                                  <p>
                                                       Para los empresas que se animen a publicar en el mundo digital de Moto Popular ofrecemos numerosos beneficios:
                                                  </p>
                                             </div>
                                             <div class="vinetas mt-4">
                                                  <div class="boxDescription">
                                                       <p class="mb-3">
                                                            <span class="colorYellow">Solo pagas cuando consigues un cliente:</span> Moto Popular cobra una comisión cuando te entrega los datos completos de un cliente que haya pasado la evaluación financiera o desee pagar al contado.
                                                       </p>
                                                       <p class="mb-3">
                                                            <span class="colorYellow">Publicidad digital indirecta:</span> Moto Popular invierte en anuncios de Google y Facebook ADS para lograr más visitas a la página. De esta manera, tus productos estarán en la vista del público más joven sin complicarte la vida. 
                                                       </p>
                                                       <p class="mb-3">
                                                            <span class="colorYellow">Sesión de fotos para el catálogo de Moto Popular: </span> Si no cuentas con fotos profesionales de tus productos, nosotros nos encargamos de tomar y retocar las fotos para que tus motos luzcan espectaculares. (Opcional).
                                                       </p>
                                                       <p>
                                                            <span class="colorYellow">Servicio de publicidad digital enfocada: </span> Configuración y desarrollo de estrategias y campañas de comercio electrónico para hacer crecer tu negocio (opcional).
                                                       </p>
                                                  </div>
                                             </div>
                                        </div>
                                        <div class="col-12 col-md-6 col-xl-6">
                                             <form class="separateForm" name="formAnuncia" id="formAnuncia" v-on:submit="sendData" method="POST">
                                                  <div class="boxLabel2 mt-4">
                                                       Pre Suscripción
                                                  </div>
                                                  <p class="mt-2 pLabel ">Ingresa tus datos y nos pondremos en contacto contigo muy pronto:</p>
                                                  <div class="row mt-4">
                                                       <div class="col-12 col-md-6 mb-4">
                                                            <label for="nombres">NOMBRES Y APELLIDOS:*</label>
                                                            <input type="text" name="nombres" id="nombres" class="inputForm1" autocomplete="off" v-model="form.nombres" placeholder="Ingresa tus nombres">
                                                       </div>
                                                       <div class="col-12 col-md-6 mb-4">
                                                            <label for="ruc">RUC DE LA EMPRESA:*</label>
                                                            <input type="text" name="ruc" id="ruc" class="inputForm1" autocomplete="off" v-model="form.ruc" placeholder="Ingresa RUC de la empresa">
                                                       </div>
                                                       <div class="col-12 col-md-6 mb-4">
                                                            <label for="email">CORREO ELECTRÓNICO:*</label>
                                                            <input type="text" name="email" id="email" class="inputForm1" autocomplete="off" v-model="form.email" placeholder="tucorreo@correo.com">
                                                       </div>
                                                       <div class="col-12 col-md-6 mb-4">
                                                            <label for="celular">NRO. DE CELULAR:*</label>
                                                            <input type="text" name="celular" id="celular" class="inputForm1" autocomplete="off" v-model="form.celular" placeholder="Ingresa tu número de celular">
                                                       </div>
                                                       <div class="col-12 col-md-6 col-xl-4 mb-4">
                                                            <label for="departamento">DEPARTAMENTO:*</label>
                                                            <div class="boxSelect">
                                                                 <select name="departamento" id="departamento" class="form-select" @change="onChangeDepartamento($event)"  v-model="form.departamento" aria-label="Default select example">
                                                                      <option selected value="">Selecciona departamento</option>
                                                                      <option v-for="(departament, index) in allDepartament" :key="index" :value="departament.id">{{ departament.descripcion }}</option>
                                                                 </select>
                                                                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                                                                 <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                                                                 </svg>
                                                            </div>
                                                            
                                                       </div>
                                                       <div class="col-12 col-md-6 col-xl-4 mb-4">
                                                            <label for="provincia">PROVINCIA:*</label>
                                                            <div class="boxSelect">
                                                                 <select name="provincia" id="provincia" class="form-select" @change="onChangeProvincia($event)" v-model="form.provincia" aria-label="Default select example">
                                                                      <option selected value="">Selecciona provincia</option>
                                                                      <option v-for="(province, index) in allProvinces" :key="index" :value="province.id">{{ province.descripcion }}</option>
                                                                 </select>
                                                                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                                                                 <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                                                                 </svg>
                                                            </div>
                                                       </div>
                                                       <div class="col-12 col-md-12 col-xl-4 mb-4">
                                                            <label for="distrito">DISTRITO:*</label>
                                                            <div class="boxSelect">
                                                                 <select name="distrito" id="distrito" class="form-select" v-model="form.distrito" aria-label="Default select example">
                                                                      <option selected value="">Selecciona distrito</option>
                                                                      <option v-for="(distrito, index) in allDistrito" :key="index" :value="distrito.id">{{ distrito.descripcion }}</option>
                                                                 </select>
                                                                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                                                                 <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                                                                 </svg>
                                                            </div>
                                                       </div>
                                                       
                                                  </div>
                                                  
                                                  <div class="row">
                                                       <div class="col-12">
                                                            <div class="separateAgree d-flex justify-content-left align-items-center">
                                                                 <div>
                                                                      <div class="d-flex justify-content-start align-items-center">
                                                                           <div class="boxCheckbox">
                                                                                <input type="checkbox" id="agree" name="agree" value="yes" v-model="form.agree" />
                                                                                <label for="agree"></label>
                                                                           </div>
                                                                           <p class="labelP">He leído y acepto la <a href="/terminos-condiciones" target="_blank">Política de Privacidad</a></p>
                                                                      </div>
                                                                      <label class="agree-error msnError">Debe aceptar los Términos y Condiciones </label>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                       <div class="col-12">
                                                            <div class="d-flex justify-content-center align-items-center">
                                                                 <div class="boxButton">
                                                                      <button type="submit">Enviar Solicitud</button>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                       <div class="col-12 mt-3" id="mensajeRespuesta">

                                                       </div>
                                                  </div>
                                             </form>
                                        </div>
                                   </div>
                                   
                                   
                              </div>
                              <div class="col-0 col-xl-1"></div>
                         </div>
                    </div>
               </div>
          </section>
     </div>
</template>
<script>
export default {
     props: ['slug','monto','cuotas','valor', 'soat', 'seguro'],
     data: function () {
          return {
               allDepartament: [],
               allProvinces: [],
               allDistrito: [],
               form:{
                    nombres: "",
                    celular: "",
                    ruc: "",
                    email: "",
                    departamento: "",
                    provincia: "",
                    distrito: "",
                    agree: false,
               },
          }
     },
     mounted: function() {
         this.loadFilters()
         this.loadForm()
         this.eventForm()
         this.validateElementForm()
     },
     methods: {
          resetForm(){
               this.form.nombres = ""
               this.form.celular = ""
               this.form.email = ""
               this.form.ruc = ""
               this.form.departamento = ""
               this.form.provincia = ""
               this.form.distrito = ""
               this.form.agree = false
                    
          },
          validateElementForm: function(){
               $("#ruc").keydown(function (e) {
                    if (($("#ruc").val().length < 16) || (e.keyCode == 8)){
                         if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 || (e.keyCode == 65 && e.ctrlKey === true) || (e.keyCode >= 35 && e.keyCode <= 39)) {
                              return;
                         }
                         if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                              e.preventDefault();
                         }
                    }else{
                         e.preventDefault();
                    }

               })

               $("#celular").keydown(function (e) {
                    if (($("#celular").val().length < 12) || (e.keyCode == 8)){
                         if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 || (e.keyCode == 65 && e.ctrlKey === true) || (e.keyCode >= 35 && e.keyCode <= 39)) {
                              return;
                         }
                         if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                              e.preventDefault();
                         }
                    }else{
                         e.preventDefault();
                    }

               })


               $("#nombres").keypress(function (event) {
                    let regex = new RegExp("^[a-zA-ZñÑ' ]+$")
                    var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
                    if (!regex.test(key)) {
                         event.preventDefault();
                         return false;
                    }

               })
          },
          async loadFilters(){
               try{
                    let sendSolicitud = await axios.get('/api/v1/quiero-la-moto-data')
                    // console.log(sendSolicitud)
                    if (sendSolicitud.status === 200){
                         this.allDepartament = sendSolicitud.data.data.depatamento
                    }
               }catch (error) {
                    console.log(error)
               } finally {
                    console.log('final')
               }
          },
          async onChangeProvincia(event){
               // console.log(this.form.provincia)
               this.form.distrito = ""
               try{
                    let sendSolicitud = await axios.get(`/api/v1/get-distritos?departamento_id=${this.form.departamento}&provincia_id=${this.form.provincia}`)
                    // console.log(sendSolicitud)
                    if (sendSolicitud.status === 201){
                         this.allDistrito = sendSolicitud.data.data.distritos
                    }
               }catch (error) {
                    console.log(error)
               } finally {
                    console.log('final')
               }
          },
          async onChangeDepartamento(event){
               // console.log(this.form.departamento)
               this.form.provincia = ""
               this.form.distrito = ""
               try{
                    let sendSolicitud = await axios.get(`/api/v1/get-provincias?departamento_id=${this.form.departamento}`)
                    // console.log(sendSolicitud)
                    if (sendSolicitud.status === 201){
                         this.allProvinces = sendSolicitud.data.data.provincias
                    }
               }catch (error) {
                    console.log(error)
               } finally {
                    console.log('final')
               }
          },
          
         
          loadForm: function(){
               $( "#formAnuncia" ).validate({
                    rules: {
                         nombres: {
                              required: true,
                              minlength: 2
                         },
                         celular: {
                              required: true,
                              minlength: 9
                         },
                         email: {
                              required: true,
                              email: true
                         },
                         ruc: {
                              required: true,
                         },
                         departamento: {
                              required: true,
                         },
                         provincia: {
                              required: true,
                         },
                         distrito: {
                              required: true,
                         },
                    }, 
                    messages: {
                         nombres: {
                              required: "Nombre - necesario",
                              minlength: "Como mínimo 2 caracteres"
                         },
                         celular: {
                              required: "Celular - necesario",
                              minlength: "Como mínimo 9 caracteres"
                         },
                         email: {
                              required: "Debe completar un correo válido",
                              email: "Debe completar un correo válido"
                         },
                         ruc: {
                              required: "RUC. - necesario",
                         },
                         departamento: {
                              required: "Departamento - necesario",
                         },
                         provincia: {
                              required: "Provincia - necesario",
                         },
                         distrito: {
                              required: "Distrito - necesario",
                         },
                    }
               })
          },
          eventForm: function(){
               $('#agree').on("click", function(){
                    if ($('#agree').is(':checked')) {
                         $(".agree-error").removeClass('errorManual')
                    }else{
                         $(".agree-error").addClass('errorManual')     
                    }
               })
          },
          
          async sendData(event) {
               let formData = new FormData()
               
               // let _data = {}
               // alert(1)
               event.preventDefault()
               var _flat_agree = 0
               if ($('#agree').is(':checked') != true ) {
                    // alert('no')
                    $(".agree-error").addClass('errorManual')
                    return false
               }else{
                    _flat_agree = 1
                    $(".agree-error").removeClass('errorManual')
               }
               
               // return false
               if ($("#formAnuncia").valid()) {
                    console.log("PASO")
                    // console.log(this.form)
                    // console.log(this.dataSimulacro)
                    $('.loadPageLoading').addClass('active')
                    formData.append("nombre_apellidos", this.form.nombres)
                    formData.append("celular", this.form.celular)
                    formData.append("correo", this.form.email)
                    formData.append("ruc", this.form.ruc)
                    formData.append("departamento_id", this.form.departamento)
                    formData.append("provincia_id", this.form.provincia)
                    formData.append("distrito_id", this.form.distrito)
                    formData.append("tyc", _flat_agree)
                    console.log(this.form)
                    try{
                         let sendSolicitud = await axios.post('/api/v1/store-pre-suscripcion',formData)
                         console.log(sendSolicitud)
                         $('.loadPageLoading').removeClass('active')
                         if (sendSolicitud.data.code === 201){
                              this.resetForm()
                              let _msn = "<div class='alert alert-success'  role='alert'>"
                              _msn += "<p class='txtCenter'>Sus datos han sido enviados de manera correcta</p>"
                              _msn +="</div>"
                              $("#mensajeRespuesta").html(_msn)
                         }else{
                              let _msn = "<div class='alert alert-danger' role='alert'>"
                              _msn += "<p class='txtCenter'>No se pudo enviar sus datos, intente m&aacute;s tarde</p>"
                              _msn +="</div>"
                              $("#mensajeRespuesta").html(_msn)
                         }
                    }catch (error) {
                         $('.loadPageLoading').removeClass('active')
                         let _msn = "<div class='alert alert-danger' role='alert'>"
                         _msn += "<p class='txtCenter'>No se pudo enviar sus datos, intente m&aacute;s tarde</p>"
                         _msn +="</div>"
                         $("#mensajeRespuesta").html(_msn)
                         console.log(error)
                    } finally {
                         console.log('final')
                    }
               }else{
                    console.log("no PASO")
               }
          },
          
     }
}
</script>